org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.telemetry","ver":"1.0","author":"Sunil A S","title":"Telemetry Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js"}},org.ekstep.contenteditor.basePlugin.extend({type:"org.ekstep.telemetry",service:void 0,initialize:function(){this.service=ecEditor.getService("telemetry"),ecEditor.addEventListener("content:load:complete",this.registerEvents,this),ecEditor.addEventListener("content:load:complete",this.logPluginErrors,this)},registerEvents:function(){var r=this;ecEditor.addEventListener("object:selected",function(e,t){t&&t.id&&""!=t.id&&r.interactEvent("select","","plugin",t.type,t.ver,t.id)},this),ecEditor.addEventListener("object:modified",function(e,t){t&&t.id&&""!=t.id&&r.interactEvent("modify","","plugin",t.type,t.ver,t.id)},this),ecEditor.addEventListener("object:unselected",function(e,t){t&&t.id&&""!=t.id&&r.interactEvent("unselect","","plugin",t.type,t.ver,t.id)},this),ecEditor.addEventListener("object:removed",function(e,t){if(t&&t.id&&""!=t.id){var i=ecEditor.getPluginInstance(t.id);r.service.pluginLifeCycle({type:"remove",pluginid:i.manifest.id,pluginver:i.manifest.ver,objectid:i.id,assetid:i.getAttribute("asset"),stage:ecEditor.getCurrentStage().id,containerid:"",containerplugin:""})}},this),ecEditor.addEventListener("stage:removed",function(e,t){if(t&&t.stageId&&""!=t.stageId){var i=ecEditor.getPluginInstance(t.stageId);r.service.pluginLifeCycle({type:"remove",pluginid:i.manifest.id,pluginver:i.manifest.ver,objectid:i.id,assetid:i.getAttribute("asset"),stage:i.id,containerid:"",containerplugin:""})}},this),ecEditor.addEventListener("stage:delete",function(e,t){t&&t.stageId&&""!=t.stageId&&r.interactEvent("click","delete","plugin","org.ekstep.stage","1.0",t.stageId)},this),ecEditor.addEventListener("stage:duplicate",function(e,t){t&&t.stageId&&""!=t.stageId&&r.interactEvent("duplicate","","plugin","org.ekstep.stage","1.0",t.stageId)},this),ecEditor.addEventListener("stage:select",function(e,t){t&&t.stageId&&""!=t.stageId&&r.interactEvent("select","","plugin","org.ekstep.stage","1.0",t.stageId)},this),ecEditor.addEventListener("stage:reorder",function(e,t){t&&t.stageId&&""!=t.stageId&&r.interactEvent("modify","reorder","stage","org.ekstep.stage","1.0",t.stageId)},this),ecEditor.addEventListener("plugin:load",function(e,t){t&&r.service.pluginLifeCycle({type:"load",pluginid:t.plugin,pluginver:t.version,objectid:"",stage:"",containerid:"",containerplugin:""})},this),ecEditor.addEventListener("plugin:add",function(e,t){var i=ecEditor.getCurrentStage()?ecEditor.getCurrentStage().id:"";t&&r.service.pluginLifeCycle({type:"add",pluginid:t.plugin,pluginver:t.version,objectid:t.instanceId,stage:i,containerid:"",containerplugin:""})},this),ecEditor.addEventListener("plugin:error",function(e,t){var i=ecEditor.getService("content").getContentMeta(org.ekstep.contenteditor.api.getContext("contentId")).pkgVersion,n={id:org.ekstep.contenteditor.api.getContext("contentId"),ver:!_.isUndefined(i)&&i.toString()||"0",type:"Content"};r.service.error({err:t.err,errtype:"CONTENT",stacktrace:t.stackTrace||"",object:n,plugin:{id:t.plugin,ver:t.version,category:""}})},this)},interactEvent:function(e,t,i,n,r,d){this.service.interact({type:e,subtype:t,target:i,pluginid:n,pluginver:r,objectid:d,stage:ecEditor.getCurrentStage().id})},logPluginErrors:function(e,t){var i=this,n=ecEditor.getService("content").getContentMeta(org.ekstep.contenteditor.api.getContext("contentId")).pkgVersion,r={id:org.ekstep.contenteditor.api.getContext("contentId"),ver:!_.isUndefined(n)&&n.toString()||"0",type:"Content"},d=org.ekstep.pluginframework.pluginManager.getErrors();_.each(d,function(e){i.service.error({err:e.error,errtype:"CONTENT",stacktrace:e.stackTrace||"",object:r,plugin:{id:e.plugin,ver:e.version,category:""}})})}}))